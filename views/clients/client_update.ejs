<%- include('../partials/head') -%>
<body class="d-flex flex-column vh-100" style="min-height: 100vh">
  <%- include('../partials/navbar') -%>
  <div class="d-flex flex-column flex-grow-1 bg-light">
    <%- include('../partials/sidenav') -%>

    <main
      class="container px-3 mx-auto w-100 h-100 my-5"

    >
      <div class="bg-white shadow-sm p-4 position-relative card-max-width">
        <h1 class="mb-4 fs-4">Update Client</h3>

        <!-- Button trigger modal -->
        <a
          type="button"
          class="d-block position-absolute mx-3 my-5 text-danger"
          data-bs-toggle="modal"
          data-bs-target="#myModal"
          style="right: 0; top: 0"
          aria-label="delete-client"
        >
        <i class="fa-light fa-trash-can fs-4"></i>
        </a>

        <!-- Modal -->
        <div
          class="modal fade"
          id="myModal"
          tabindex="-1"
          aria-labelledby="exampleModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog">
            <div class="modal-content py-2 px-3">
              <div class="modal-header mx-3 px-0 pb-2">
                <h5 class="modal-title" id="exampleModalLabel">
                  Confirm Client Deletion
                </h5>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                ></button>
              </div>
              <div class="modal-body text-danger">
                Client details will be permanently deleted.
              </div>
              <form
                action="/clients/<%-c._id%>?_method=DELETE"
                method="POST"
                class="w-100"
              >
                <div class="modal-footer  border-0">
                  <button type="submit" class="btn btn-danger">
                    Delete Client
                  </button>
                  <button
                    type="button"
                    class="btn btn-secondary"
                    data-bs-dismiss="modal"
                  >
                    Cancel
                  </button>
                  
                </div>
              </form>
            </div>
          </div>
        </div>
        <form action="/clients/<%-c._id%>?_method=PUT" method="POST">
          <h6 class="mt-4 mb-3">Personal Information</h6>
          <!-- title -->
          <div class="mb-3">
            <label class="d-block small text-muted mb-1" for="inputEmail4"
              >Title</label
            >
            <div class="form-check form-check-inline">
              <input
                class="form-check-input title-option"
                type="radio"
                name="client[title]"
                id="titlenMr"
                value="Mr"
                required
              />
              <label class="form-check-label" for="titleMr">Mr</label>
            </div>
            <div class="form-check form-check-inline">
              <input
                class="form-check-input title-option"
                type="radio"
                name="client[title]"
                id="titleMrs"
                value="Mrs"
                required
              />
              <label class="form-check-label" for="titleMrs">Mrs</label>
            </div>
            <div class="form-check form-check-inline">
              <input
                class="form-check-input title-option"
                type="radio"
                name="client[title]"
                id="titleMiss"
                value="Miss"
                required
              />
              <label class="form-check-label" for="titleMiss">Miss</label>
            </div>
            <div class="form-check form-check-inline">
              <input
                class="form-check-input title-option"
                type="radio"
                name="client[title]"
                id="titleDr"
                value="Dr"
                required
              />
              <label class="form-check-label" for="titleDr">Dr</label>
            </div>
          </div>
          <!-- title -->
          <!-- name -->
          <div class="row">
            <div class="form-group col-md-6">
              <label class="small text-muted mb-1" for="firstName"
                >First Name *</label
              >
              <input
                type="text"
                class="form-control mb-2"
                id="firstName"
                name="client[firstName]"
                placeholder=""
                pattern="^[^0-9]+$"
                value="<%- c.firstName %>"
                required
              />
            </div>

            <div class="form-group col-md-6">
              <label class="small text-muted mb-1" for="lastName"
                >Last Name *</label
              >
              <input
                type="text"
                class="form-control mb-2"
                id="lastName"
                placeholder=""
                name="client[lastName]"
                pattern="^[^0-9]+$"
                value="<%- c.lastName %>"
                required
              />
            </div>
          </div>
          <div class="row">
            <div class="form-group col-md-6">
              <label class="small text-muted mb-1" for="preferredName"
                >Preferred Name</label
              >
              <input
                type="text"
                class="form-control mb-2"
                id="preferredName"
                placeholder=""
                name="client[preferredName]"
                pattern="^[^0-9]+$"
                value="<%- c.preferredName %>"
                required
              />
            </div>
            <div class="form-group col-md-6">
              <label class="small text-muted mb-1" for="dateOfBirth"
                >Date of Birth</label
              >
              <input
                type="date"
                class="form-control mb-2"
                id="dateOfBirth"
                placeholder=""
                name="client[dob]"
                pattern="^[^0-9]+$"
                value="<%- c.dateValue %>"
                required
              />
            </div>
          </div>

          <div class="row">
            <h6 class="mt-4 mb-3">Occupation Details</h6>
            <!-- <label class="d-block fw-bold mb-2">Name:</label> -->
            <div class="form-group col-md-6">
              <label class="small text-muted mb-1" for="jobTitle"
                >Job Title</label
              >
              <input
                type="text"
                class="form-control mb-2"
                id="jobTitle"
                name="client[jobTitle]"
                placeholder=""
                pattern="^[^0-9]+$"
                value="<%- c.jobTitle %>"
                required
              />
            </div>

            <div class="form-group col-md-6">
              <label class="small text-muted mb-1" for="company">Company</label>
              <input
                type="text"
                class="form-control mb-2"
                id="company"
                placeholder=""
                name="client[company]"
                pattern="^[^0-9]+$"
                value="<%- c.company %>"
                required
              />
            </div>
          </div>

          <h6 class="mt-4 mb-3">Contact Information</h6>

          <div class="form-row row mb-3">
            <div class="form-group col-md-6">
              <label class="text-muted small mb-1" for="phone"
                >Phone Number *</label
              >
              <input
                type="text"
                class="form-control mb-2"
                id="phone"
                placeholder="0400 000 000"
                name="client[phone]"
                value="<%- c.phone %>"
                required
              />
            </div>
            <div class="col-md-6">
              <label class="text-muted small mb-1" for="email">Email *</label>
              <input
                type="email"
                class="form-control mb-2"
                id="email"
                placeholder="example@mail.com"
                name="client[email]"
                value="<%- c.email %>"
                required
              />
            </div>
          </div>

          <h6 class="mt-4 mb-3">Address</h6>

          <div class="form-group col-12 mb-2">
            <label class="text-muted small mb-1" for="street">Street</label>
            <input
              type="text"
              class="form-control"
              id="street"
              placeholder=""
              name="client[address][street]"
              value="<%- c.address.street %>"
              required
            />
          </div>

          <div class="row">
            <div class="form-group col-md-6">
              <label class="text-muted small mb-1" for="suburb">Suburb</label>
              <input
                type="text"
                class="form-control mb-2"
                id="suburb"
                placeholder=""
                name="client[address][suburb]"
                pattern="^[^0-9]+$"
                value="<%- c.address.suburb %>"
                required
              />
            </div>

            <div class="form-group col-6 col-md-3">
              <label class="text-muted small mb-1" for="state">State</label>
              <select
                name="client[address][state]"
                id="state"
                class="form-select"
                required
              >
                <option value="" hidden class="text-muted" selected></option>
                <option class="state-option" value="NSW">NSW</option>
                <option class="state-option" value="QLD">QLD</option>
                <option class="state-option" value="VIC">VIC</option>
                <option class="state-option" value="WA">WA</option>
                <option class="state-option" value="SA">SA</option>
                <option class="state-option" value="ACT">ACT</option>
              </select>
            </div>

            <div class="form-group col-6 col-md-3">
              <label class="text-muted small mb-1" for="postcode"
                >Postcode</label
              >
              <input
                type="text"
                pattern="[0-9]{4}"
                class="form-control"
                id="postcode"
                placeholder=""
                name="client[address][postcode]"
                value="<%- c.address.postcode %>"
                required
              />
            </div>
          </div>

          <div class="d-flex justify-content-between mt-4">
            <button type="submit" class="btn btn-primary">Save Client</button>
          </div>
        </form>
      </div>
    </main>
  </div>
  <%- include('../partials/footer') -%>
</body>

<script>
  const titleOptions = document.querySelectorAll(".title-option");
  const title = "<%-c.title%>";

  titleOptions.forEach((option) => {
    if (title == option.value) {
      option.checked = true;
    }
  });

  let prefilSelect = (currentVal, options) => {
    options.forEach((option) => {
      if (currentVal == option.value) {
        option.setAttribute("selected", "selected");
      }
    });
  };

  const stateOptions = document.querySelectorAll(".state-option");
  const addressState = "<%-c.address.state%>";
  prefilSelect(addressState, stateOptions);
</script>
